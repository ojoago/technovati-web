{"version":3,"file":"js/8022.6f100fe5.js","mappings":"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","sources":["webpack://Technovati/./src/composables/formatError.js","webpack://Technovati/./src/views/accounts/sales/AddSales.vue","webpack://Technovati/./src/views/accounts/sales/AddSales.vue?0285"],"sourcesContent":["\r\nexport function formatError() {\r\n    function transformValidationErrors(response , handleType = 'axios'){\r\n        const errors = []\r\n        if(handleType == 'axios'){\r\n            if(response){\r\n                for (let key in response) {\r\n                    if(key.indexOf('.') !== -1){\r\n                        let k = trimKey(key);\r\n                        errors[k] = response[key][0]\r\n                    }else{\r\n                        errors[key] = response[key][0]\r\n                    }\r\n                    errors[key] = response[key][0]\r\n                }\r\n            }\r\n        }\r\n        return errors\r\n    }\r\n    \r\n    function trimKey(key){\r\n        const parts = key.split('.').filter(part => (part));\r\n        const part = key.split('.').filter(part => !isNaN(part));\r\n       \r\n        // const numericValues = parts.map(Number);\r\n        return parts[2]+part.map(Number);\r\n\r\n// console.log(numericValues);\r\n    }\r\n\r\n    return {\r\n        transformValidationErrors\r\n    }\r\n}","<template>\r\n    <div>\r\n        <div class=\"container mt-2\">\r\n            <div class=\"card\">\r\n                <div class=\"card-header\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-6\">\r\n                           <h3>Add Sales</h3>\r\n                        </div>\r\n                        <div class=\"col-md-6\">\r\n                            <select class=\"form-control\" @change=\"loadItem($event.target.value)\">\r\n                                <option value=\"\" selected>Select Store</option>\r\n                                <template v-for=\"sec in stores\" :key=\"sec.id\">\r\n                                    <option v-if=\"stores.length == 1\" selected :value=\"sec.id\">{{ sec.text }}\r\n                                    </option>\r\n                                    <option v-else :value=\"sec.id\">{{ sec.text }} </option>\r\n                                </template>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"card-body\">\r\n\r\n                    <input type=\"text\" class=\" form-control form-control-sm\" placeholder=\"search Item\">\r\n                    <div class=\"table-responsive\">\r\n                        <table class=\"table-hover table-stripped table-bordered table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th width=\"5%\">SN</th>\r\n                                    <th>Name</th>\r\n                                    <!-- <th>Model</th> -->\r\n                                    <th>Quantity</th>\r\n                                    <!-- <th>Description</th> -->\r\n                                    <th align=\"center\"> <i class=\"bi bi-gear-fill\"></i> </th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr v-for=\"(item, loop) in items?.data\" :key=\"loop\">\r\n                                    <td>{{ loop + 1 }}</td>\r\n                                    <td>{{ item.name }}</td>\r\n                                    <!-- <td>{{ item.model }} </td> -->\r\n                                    <td>{{ item?.quantity ?? 0 }} {{ item.unit }}</td>\r\n                                    <td>\r\n                                        <button v-if=\"item?.quantity > 0\" @click=\"addItem(item)\" type=\"button\"\r\n                                            class=\"btn btn-primary btn-sm\">\r\n                                            <i class=\"bi bi-plus\"></i>\r\n                                        </button>\r\n                                    </td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n\r\n                    </div>\r\n\r\n                    <form id=\"itemForm\" v-if=\"sales.items.length\">\r\n                        <hr>\r\n\r\n                        <div class=\"row\">\r\n                            <div class=\"col-md-5\">\r\n                                <fieldset class=\"border rounded-3 p-1\" id=\"requestBody\">\r\n                                    <legend class=\"float-none w-auto px-2 h5\">Request Items</legend>\r\n\r\n                                    <fieldset class=\"border rounded-3 p-2 m-1\">\r\n                                        <div class=\"row\" v-for=\"(item, loop) in sales.items\" :key=\"loop\">\r\n                                            <div class=\"col-md-12\">\r\n                                                <label class=\"form-label\">{{ item.name }} </label>\r\n                                            </div>\r\n                                            <div class=\"col-md-6\">\r\n                                                <div class=\"form-group\">\r\n                                                    <label class=\"form-label\">Qty</label>\r\n                                                    <div class=\"input-group\">\r\n                                                        <span class=\"bg-light p-1\">#{{ item.qnt }}</span>\r\n                                                        <input type=\"number\" v-model=\"item.quantity\" @change=\"subTotal\"\r\n                                                            class=\"form-control\" placeholder=\"e.g 100\">\r\n\r\n                                                    </div>\r\n                                                    <p class=\"text-danger \" v-if=\"errors[`items.${loop}.quantity`]\">{{ errors[`items.${loop}.quantity`] }} </p>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class=\"col-md-6\">\r\n                                                <div class=\"form-group\">\r\n                                                    <label for=\"\" class=\"form-label\">Rate</label>\r\n                                                    <div class=\"input-group\">\r\n                                                        <input type=\"number\" v-model=\"item.rate\" @change=\"subTotal\"\r\n                                                            class=\"form-control\" placeholder=\"e.g 30000\">\r\n                                                        <button type=\"button\" class=\"btn btn-danger btn-sm\"\r\n                                                            @click=\"removeitem(loop)\"> <i\r\n                                                                class=\"bi bi-file-minus-fill\"></i>\r\n                                                        </button>\r\n                                                    </div>\r\n                                                    <p class=\"text-danger \" v-if=\"errors[`items.${loop}.rate`]\">{{ errors[`items.${loop}.rate`] }} </p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                        </div>\r\n                                    </fieldset>\r\n\r\n                                    <div class=\"row\">\r\n\r\n                                        <div class=\"col-md-12\">\r\n                                            <label class=\"form-label\">Customer</label>\r\n                                            <Select2 v-model=\"sales.customer_pid\" :options=\"customerDrop\"\r\n                                                :settings=\"{ width: '100%' }\" placeholder=\"Select Customer\" />\r\n\r\n                                            <p class=\"text-danger \" v-if=\"errors?.customer_pid\">{{\r\n                                                errors?.customer_pid }} </p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n\r\n\r\n                                </fieldset>\r\n                            </div>\r\n                            <div class=\"col-md-7\">\r\n                                <fieldset class=\"border rounded-3 p-2 m-1\">\r\n                                    <legend class=\"float-none w-auto px-2\">Payment, <small>Sub Total {{\r\n                                            numberFormat(sales.sub_total) }}</small></legend>\r\n\r\n                                    <br>\r\n\r\n\r\n                                    <div class=\"row\">\r\n                                        <div class=\"col-md-12\">\r\n                                            <div class=\"form-group\">\r\n                                                <label for=\"\">Bill to</label>\r\n                                                <textarea class=\"form-control form-control-sm\" placeholder=\"Bill to\"\r\n                                                    v-model=\"sales.bill_to\"></textarea>\r\n                                                <p class=\"text-danger \" v-if=\"errors?.bill_to\">{{ errors?.bill_to }} </p>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"col-md-12\">\r\n                                            <div class=\"form-group\">\r\n                                                <label for=\"\">Ship to</label>\r\n                                                <textarea class=\"form-control form-control-sm\" placeholder=\"Ship to\"\r\n                                                    v-model=\"sales.ship_to\"></textarea>\r\n                                                <p class=\"text-danger \" v-if=\"errors?.ship_to\">{{ errors?.ship_to }} </p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div class=\"col-md-6\">\r\n                                            <div class=\"form-group\">\r\n                                                <label class=\"form-label small\">Discount</label>\r\n                                                <input type=\"number\" step=\"0.5\" @change=\"sumPaid\"\r\n                                                    v-model=\"sales.discount\" class=\"form-control form-control-sm\"\r\n                                                    placeholder=\"Discount\">\r\n                                                <p class=\"text-danger \" v-if=\"errors?.discount\">{{ errors?.discount }} </p>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"col-md-6\">\r\n                                            <div class=\"form-group\">\r\n                                                <label class=\"form-label small\">Tax</label>\r\n                                                <div class=\"input-group\">\r\n                                                    <input type=\"text\" class=\"form-control form-control-sm\"\r\n                                                        v-model=\"sales.tax\" @change=\"sumPaid\" placeholder=\"e.g 3%\">\r\n                                                    <select v-model=\"sales.tax_type\" @change=\"sumPaid\" class=\"\"\r\n                                                        style=\"width: 60px !important;\">\r\n                                                        <option value=\"1\" selected>%</option>\r\n                                                        <option value=\"2\">Flat</option>\r\n                                                    </select>\r\n                                                </div>\r\n                                                <p v-if=\"errors.tax\" class=\"text-danger\">\r\n                                                    {{ errors.tax}} </p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n\r\n                                    <div class=\"row\">\r\n                                        <div class=\"col-md-6\">\r\n                                            <div class=\"form-group\">\r\n                                                <label class=\" small\">Total</label>\r\n                                                <input type=\"text\" readonly :value=\"grand_total\"\r\n                                                    class=\"form-control form-control-sm\" placeholder=\"Total\" />\r\n                                            </div>\r\n\r\n                                        </div>\r\n                                        <div class=\"col-md-6\">\r\n\r\n                                            <div class=\"form-group\">\r\n                                                <label class=\" small\">Tax Value</label>\r\n                                                <input type=\"text\" readonly v-model=\"sales.tax_value\"\r\n                                                    class=\"form-control form-control-sm\" placeholder=\"Tax Value\" />\r\n                                                <p class=\"text-danger \" v-if=\"errors?.tax_value\">{{errors?.tax_value }}</p>\r\n\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div class=\"form-group\">\r\n                                        <label class=\" small\">Grand Total</label>\r\n                                        <input type=\"text\" readonly :value=\"grand_total\"\r\n                                            class=\"form-control form-control-sm\" placeholder=\"Select Account\" />\r\n                                    </div>\r\n\r\n                                    \r\n                                    <hr>\r\n\r\n                                    <div class=\"col-md-12\">\r\n                                            <label class=\"form-label small\">Record Sale In</label>\r\n                                            <select class=\"form-control\" v-model=\"sales.account_type_pid\"\r\n                                                @change=\"dropDownAccount($event.target.value)\">\r\n                                                <option value=\"\" selected>Select Type</option>\r\n                                                <option v-for=\"sec in accountTypeDrop\" :key=\"sec.id\" :value=\"sec.id\">{{\r\n                                                    sec.text }} </option>\r\n                                            </select>\r\n\r\n                                            <p class=\"text-danger \" v-if=\"errors?.account_pid\">{{\r\n                                                errors?.account_pid }} </p>\r\n                                        </div>\r\n\r\n                                    <div class=\"row\" v-for=\"(pay, loop) in sales.accounts\" :key=\"loop\">\r\n\r\n                                        <div class=\"col-md-5\">\r\n                                            <div class=\"form-group\">\r\n                                                <label class=\"form-label small\">Account</label>\r\n                                                <Select2 v-model=\"pay.account_pid\" :options=\"accountDrop\"\r\n                                                    :settings=\"{ width: '100%' }\" placeholder=\"Select Account\" />\r\n                                                <p class=\"text-danger \" v-if=\"errors[`accounts.${loop}.account_pid`]\">{{errors[`accounts.${loop}.account_pid`] }}</p>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"col-md-4\">\r\n                                            <div class=\"form-group\">\r\n                                                <label class=\"form-label small\">Amount</label>\r\n                                                <input type=\"number\" v-model=\"pay.amount\" @change=\"sumPaid\" step=\".05\"\r\n                                                    class=\"form-control form-control-sm\" placeholder=\"e.g 200000\" />\r\n                                                <p class=\"text-danger \" v-if=\"errors[`accounts.${loop}.amount`]\">{{errors[`accounts.${loop}.amount`] }}</p>\r\n\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"col-md-3\">\r\n                                            <div class=\"form-group\">\r\n                                                <label class=\"form-label small\">Date</label>\r\n                                                <div class=\"input-group\">\r\n                                                    <input type=\"date\" v-model=\"pay.date\" step=\".05\"\r\n                                                        class=\"form-control form-control-sm\"\r\n                                                        placeholder=\"Select Account\" />\r\n                                                    <button type=\"button\" class=\"btn btn-danger btn-sm\"\r\n                                                        @click=\"removeAccount(loop)\">\r\n                                                        <i class=\"bi bi-patch-minus\"></i> </button>\r\n                                                </div>\r\n                                                <p class=\"text-danger \" v-if=\"errors[`accounts.${loop}.date`]\">{{errors[`accounts.${loop}.date`] }}</p>\r\n\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                    </div>\r\n                                     <button type=\"button\" class=\"btn btn-success btn-sm mt-2\" @click=\"addAccount\">\r\n                                        <i class=\"bi bi-plus\"></i> </button>\r\n                                    <hr>\r\n                                    <div class=\"row\">\r\n                                        <div class=\"col-md-6\">\r\n                                            <div class=\"form-group\">\r\n                                                <label class=\" small\">Paid</label>\r\n                                                <input type=\"text\" readonly v-model=\"sales.paid\"\r\n                                                    class=\"form-control form-control-sm\" placeholder=\"Amount Paid\" />\r\n                                            </div>\r\n\r\n                                        </div>\r\n                                        <div class=\"col-md-6\">\r\n\r\n                                            <div class=\"form-group\">\r\n                                                <label class=\" small\">Balance</label>\r\n                                                <input type=\"text\" readonly v-model=\"sales.balance\"\r\n                                                    class=\"form-control form-control-sm\" placeholder=\"Balance\" />\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                   \r\n\r\n                                </fieldset>\r\n                                <div class=\"text-center\">\r\n                                    <button type=\"button\" class=\"btn btn-success mt-2 mb-2\"\r\n                                        @click=\"addSales\">Submit</button>\r\n                                </div>\r\n                            </div>\r\n\r\n\r\n                        </div>\r\n\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport store from \"@/store\";\r\nimport { onMounted, ref } from \"vue\";\r\nimport Select2 from 'vue3-select2-component';\r\n// import { useRouter } from 'vue-router';\r\nimport { useHelper } from '@/composables/helper';\r\nimport { formatError } from \"@/composables/formatError\";\r\nconst { numberFormat } = useHelper()\r\nconst { transformValidationErrors } = formatError()\r\n// const router = useRouter()\r\nconst errors = ref({});\r\nconst items = ref({});\r\n\r\nconst sales = ref({\r\n    account_type_pid: '',\r\n    customer_pid: '',\r\n    store_pid: '',\r\n    sales_date: '',\r\n    tax: 0,\r\n    tax_value: 0,\r\n    tax_type: 1,\r\n    sales_no: '',\r\n    due_date: '',\r\n    bill_to: '',\r\n    ship_to: '',\r\n    discount: 0,\r\n    sub_total: 0,\r\n    paid: 0,\r\n    balance: 0,\r\n    items: [],\r\n    accounts: [{\r\n        account_pid: '',\r\n        amount: '',\r\n        date: '',\r\n        note: ''\r\n    }],\r\n});\r\n\r\nconst resetAttr = () => {\r\n    sales.value = {\r\n        account_type_pid: '',\r\n        customer_pid: '',\r\n        store_pid: '',\r\n        sales_date: '',\r\n        tax: 0,\r\n        tax_value: 0,\r\n        tax_type: 1,\r\n        sales_no: '',\r\n        due_date: '',\r\n        bill_to: '',\r\n        ship_to: '',\r\n        discount: 0,\r\n        sub_total: 0,\r\n        paid: 0,\r\n        balance: 0,\r\n        items: [],\r\n        accounts: [{\r\n            account_pid: '',\r\n            amount: '',\r\n            date: '',\r\n            note: ''\r\n        }],\r\n    }\r\n}\r\n\r\nconst addItem = (item) => {\r\n    var index = sales.value.items.findIndex(x => x.item_pid == item.pid)\r\n    if (index === -1) {\r\n        sales.value.items.push({\r\n            item_pid: item.pid,\r\n            quantity: 1,\r\n            rate: '',\r\n            qnt: item?.quantity,\r\n            name: item.name,\r\n        })\r\n    } else {\r\n        if (sales.value.items[index].quantity < item?.quantity) {\r\n            sales.value.items[index].quantity++\r\n            subTotal()\r\n        } else {\r\n            store.commit('notify', { message: `quantity remaining is : ${sales.value.items[index].quantity}`, type: 'warninig' })\r\n        }\r\n    }\r\n}\r\n\r\nconst removeitem = (i) => {\r\n    // let len = request.value.items.length;\r\n    // if (len === 1) {\r\n    //     store.commit('notify', { message: 'Qualification requires at least one instituion', type: 'warning' })\r\n    //     return;\r\n    // }\r\n    sales.value.items.splice(i, 1);\r\n    subTotal()\r\n}\r\n\r\n\r\nconst subTotal = () => {\r\n    sales.value.sub_total = 0\r\n    sales.value.items.forEach((item) => {\r\n        if (item.quantity > 0 && item.rate > 0) {\r\n            sales.value.sub_total += item.quantity * item.rate;\r\n        }\r\n        sumPaid()\r\n    })\r\n}\r\n\r\nconst grand_total = ref(0)\r\n\r\nconst sumPaid = () => {\r\n    let s=0\r\n    sales.value.accounts.forEach((item) => {\r\n        if (item.amount > 0) {\r\n            s += item.amount;\r\n        }\r\n    })\r\n    if (sales.value.tax_type == 1) {\r\n        sales.value.tax_value = sales.value.tax * sales.value.sub_total / 100\r\n    } else {\r\n        sales.value.tax_value = sales.value.tax + sales.value.sub_total\r\n    }\r\n    let b = sales.value.sub_total + sales.value.tax_value - sales.value.discount - s;\r\n    grand_total.value = numberFormat(sales.value.sub_total + sales.value.tax_value - sales.value.discount)\r\n    sales.value.paid = numberFormat(s)\r\n    sales.value.balance =  numberFormat(b)\r\n    let value = sales.value.tax_value\r\n    sales.value.tax_value = numberFormat(value)\r\n}\r\n\r\n// const vat = () => {\r\n//     if (sales.value.tax_type == 1) {\r\n//         sales.value.tax_value = sales.value.tax * sales.value.sub_total / 100\r\n//     } else {\r\n//         sales.value.tax_value = sales.value.tax + sales.value.sub_total\r\n//     }\r\n//     sumPaid()\r\n// }\r\n\r\n\r\nconst addAccount = () => {\r\n    sales.value.accounts.push({\r\n        account_pid: '',\r\n        amount: '',\r\n        date: '',\r\n        note: ''\r\n    })\r\n}\r\n\r\nconst removeAccount = (i) => {\r\n    let len = sales.value.accounts.length;\r\n    if (len === 1) {\r\n        store.commit('notify', { message: 'One Account is required', type: 'warning' })\r\n        return;\r\n    }\r\n    sales.value.accounts.splice(i, 1);\r\n}\r\n\r\n\r\nconst addSales = () => {\r\n    errors.value = []\r\n    sales.value.store_pid = selectedStore.value\r\n    store.dispatch('postMethod', { url: '/add-sales', param: sales.value }).then((data) => {\r\n        if (data?.status == 422) {\r\n            errors.value = transformValidationErrors(data.data) \r\n        } else if (data?.status == 201) {\r\n            resetAttr()\r\n        }\r\n    }).catch(e => {\r\n        console.log(e);\r\n    })\r\n}\r\n\r\nconst selectedStore = ref(null)\r\n\r\nfunction loadItem(pid) {\r\n    resetAttr()\r\n    selectedStore.value = pid \r\n    store.dispatch('getMethod', { url: '/load-cr-out-items/'+pid }).then((data) => {\r\n        if (data?.status == 200) {\r\n            items.value = data.data;\r\n        }else{\r\n            items.value = []\r\n        }\r\n       \r\n    }).catch(e => {\r\n        console.log(e);\r\n    })\r\n}\r\n\r\nif (sales.value.items){\r\n    loadStateRes()\r\n}\r\n\r\nconst customerDrop = ref([]);\r\n\r\nfunction loadStateRes() {\r\n    store.dispatch('loadDropdown', 'customers' ).then(({ data }) => {\r\n        customerDrop.value = data;\r\n    }).catch(e => {\r\n        console.log(e);\r\n    })\r\n}\r\n\r\nconst stores = ref({})\r\nfunction dropdownSection() {\r\n    store.dispatch('loadDropdown', 'stores').then(({ data }) => {\r\n        if (data.length == 1) {\r\n            loadItem(data[0].id)\r\n        }\r\n        stores.value = data;\r\n    }).catch(e => {\r\n        console.log(e);\r\n    })\r\n}\r\ndropdownSection()\r\n\r\nconst accountDrop = ref({});\r\nfunction dropDownAccount(pid) {\r\n    sales.value.accounts = [{\r\n        account_pid: '',\r\n        amount: '',\r\n        date: '',\r\n        note: ''\r\n    }]\r\n    store.dispatch('loadDropdown', 'type-accounts/'+pid).then(({ data }) => {\r\n        accountDrop.value = data;\r\n    }).catch(e => {\r\n        console.log(e);\r\n    })\r\n}\r\ndropDownAccount()\r\n\r\nconst accountTypeDrop = ref({});\r\nfunction dropDownAccountType() {\r\n    store.dispatch('loadDropdown', 'account-types').then(({ data }) => {\r\n        accountTypeDrop.value = data;\r\n    }).catch(e => {\r\n        console.log(e);\r\n    })\r\n}\r\ndropDownAccountType()\r\n\r\n\r\nonMounted(() => {\r\n      let tsk = localStorage.getItem('TVATI_EDIT_SLS') ? JSON.parse(localStorage.getItem('TVATI_EDIT_SLS')) : 'null'\r\n         if (tsk != 'null') {\r\n            loadItem(tsk.store_pid)\r\n            dropDownAccount(tsk.account_type_pid)\r\n            sales.value  = tsk;\r\n            sales.value.old_accounts  = tsk.accounts;\r\n            subTotal()\r\n         }\r\n   \r\n});\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n\r\n</style>","import script from \"./AddSales.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AddSales.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["formatError","transformValidationErrors","response","handleType","errors","key","indexOf","k","trimKey","parts","split","filter","part","isNaN","map","Number","numberFormat","useHelper","ref","items","sales","account_type_pid","customer_pid","store_pid","sales_date","tax","tax_value","tax_type","sales_no","due_date","bill_to","ship_to","discount","sub_total","paid","balance","accounts","account_pid","amount","date","note","resetAttr","value","addItem","item","index","findIndex","x","item_pid","pid","push","quantity","rate","qnt","name","subTotal","store","commit","message","type","removeitem","i","splice","forEach","sumPaid","grand_total","s","b","addAccount","removeAccount","len","length","addSales","selectedStore","dispatch","url","param","then","data","status","catch","e","console","log","loadItem","loadStateRes","customerDrop","stores","dropdownSection","id","accountDrop","dropDownAccount","accountTypeDrop","dropDownAccountType","onMounted","tsk","localStorage","getItem","JSON","parse","old_accounts","__exports__"],"sourceRoot":""}